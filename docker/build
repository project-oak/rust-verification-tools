#!/usr/bin/env bash

set -e

# Build each image
#
# Note that each image is built in a subdirectory to avoid breaking
# Docker's caching.
#
# Note too that all these commands except the final rvt command
# make snapshots of git repos.
# Images should be deleted and rebuilt to get any changes from the
# git repos.

(cd docker/base    && ../mkimage rvt_base       Dockerfile)
(cd docker/rustc   && ../mkimage rvt_rustc      Dockerfile)
(cd docker/minisat && ../mkimage rvt_minisat    Dockerfile)
(cd docker/stp     && ../mkimage rvt_stp        Dockerfile)
(cd docker/klee    && ../mkimage rvt_klee       Dockerfile)

docker/mkimage rvt docker/rvt_Dockerfile
